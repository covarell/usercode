process Alignment = {
 
	# initialize  MessageLogger
	# include "FWCore/MessageLogger/data/MessageLogger.cfi"
	service = MessageLogger { 
		untracked vstring destinations = { "cout", "alignment" } # .log automatically
		untracked vstring statistics = { "cout", "alignment"}

		untracked vstring categories = { "Alignment" }
		
		untracked PSet cout    = { 
			untracked string threshold = "DEBUG" 
			untracked bool noLineBreaks = true 
		}
		untracked PSet alignment  = { 
			untracked string threshold = "INFO" 
			untracked PSet INFO = { untracked int32 limit = 0 }
			untracked PSet WARNING = { untracked int32 limit = 0 }
			untracked PSet ERROR = { untracked int32 limit = 0 }
			untracked PSet DEBUG = { untracked int32 limit = 0 }
			untracked PSet Alignment = { untracked int32 limit = -1}
			untracked bool noLineBreaks = true 
		}
	}
	
	# initialize magnetic field
	include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"
	
	# ideal geometry and interface
	include "Geometry/CMSCommonData/data/cmsIdealGeometryXML.cfi"
	include "Geometry/TrackerNumberingBuilder/data/trackerNumberingGeometry.cfi"
	
	# track selection for alignment
	module AlignmentTracks = AlignmentTrackSelectorModule {
		InputTag src = TrackHitFilter
		bool filter = false
		
		bool applyBasicCuts = true
		double ptMin   = 10. 
		double ptMax   = 999.
		double etaMin  = -2.4.
		double etaMax  =  2.4.
		double phiMin  = -3.1416
		double phiMax  =  3.1416
		double nHitMin =  0
		double nHitMax = 99
		double chi2nMax= 999999.
		
		bool applyNHighestPt = false
		int32 nHighestPt = 2
		
		bool applyMultiplicityFilter = true
		int32 minMultiplicity = 1
	}
	
	# Alignment producer (incl refitter)
	include "Alignment/CommonAlignmentProducer/data/AlignmentProducer.cff"
        replace AlignmentProducer.ParameterBuilder.Selector.alignParams = { "AllDets,111000" }
        replace CSA06AlignmentAlgorithm.eventPrescale = 1

        # Track hit filter
        include "Alignment/TrackHitFilter/data/TrackHitFilter.cfi"
        replace TrackHitFilter.hitSelection = "PixelAndDSStripBarrelOnly"
          
	# include "Alignment/CommonAlignmentProducer/data/TrackRefitWithHF.cff"
	
	# input file
	source = PoolSource { 
		
		untracked vstring fileNames = { 
  '/store/mc/2006/12/21/mc-physval-120-SingleMuMinus-Pt100/0000/F0D454C3-6495-DB11-8A7F-00145E1D644A.root'


		}
		untracked int32 maxEvents   = 500
		untracked uint32 skipEvents = 0
	
	}	    

       module out = PoolOutputModule 
       {
         untracked string fileName = "/data/covarell/joboutput/TrackRefitter/RefTracksMisalign_PixelAndDSStripBarrelOnly.root"
       }

	
	# path p = { TrackHitFilter, TrackRefitter, AlignmentTracks }
	path p = { TrackHitFilter, AlignmentTracks }
	
        endpath e = { out }

	# REPLACEME (needed for inserting replace statements by perl script!)

}

